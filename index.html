<script>
  async function listFromMetadata() {
    const res = await fetch('https://raw.githubusercontent.com/FloMah/awesome-n8n-templates/main/metadata.json');
    const data = await res.json();

    const contentDiv = document.getElementById('content');
    contentDiv.innerHTML = '';

    for (const category in data) {
      const section = document.createElement('div');
      section.innerHTML = `<h2>${category}</h2>
        <table border="1" cellpadding="5" cellspacing="0">
          <tr><th>Title</th><th>Description</th><th>Department</th><th>Link</th></tr>
        </table>`;
      const table = section.querySelector('table');

      data[category].forEach(item => {
        const row = document.createElement('tr');
        const filePath = encodeURIComponent(item.file).replace(/%20/g, '+');
        const url = `https://github.com/FloMah/awesome-n8n-templates/blob/main/${category}/${filePath}`;
        row.innerHTML = `
          <td>${item.title}</td>
          <td>${item.description}</td>
          <td>${item.department}</td>
          <td><a href="${url}" target="_blank">Link</a></td>
        `;
        table.appendChild(row);
      });

      contentDiv.appendChild(section);
    }
  }

  listFromMetadata();
</script>
